# Excel 中英互译工具

## 项目简介
这是一个支持多种翻译服务的Python脚本，可以选择使用有道翻译或DeepL翻译。可以智能识别Excel表格中的语言（中文或英文），然后自动互译并写入指定列。

## 功能说明
- **多翻译服务支持**：可以选择使用有道翻译或DeepL翻译
- **自定义列选择**：用户可以选择任意列作为源列（要翻译的列）和目标列（填入结果的列）
- **Excel文件预览**：运行时会显示Excel文件的前几行预览，方便用户了解文件结构
- **智能语言识别**：自动检测源列文本是中文还是英文
- **双向翻译**：
  - 如果检测到中文，自动翻译成英文
  - 如果检测到英文，自动翻译成中文
- **灵活的输入方式**：支持字母格式（A、B、C）或数字格式（1、2、3）输入列号
- **自动重试机制**：遇到频率限制错误时，自动等待后重试（最多3次）
- **可调延时设置**：可以自定义翻译间隔时间，避免触发频率限制
- 保存翻译后的Excel文件

## 使用方法

### 1. 安装依赖库
在命令行中运行：
```bash
pip install openpyxl requests
```

### 2. 获取翻译API密钥

#### 选项A：使用有道翻译（免费/付费）
1. 访问 [有道智云官网](https://ai.youdao.com/)
2. 注册并登录账号
3. 在"控制台"中创建应用
4. 获取 `AppKey` 和 `AppSecret`

#### 选项B：使用DeepL翻译（免费/付费）
1. 访问 [DeepL Pro官网](https://www.deepl.com/zh/pro-api)
2. 注册并登录账号
3. 在账户中获取 `API Key`
4. 注意：免费版有使用限制，付费版功能更强大

### 3. 配置API信息
打开 `translate_excel.py` 文件，根据你选择的翻译服务修改配置：

**如果使用有道翻译：**
```python
YOUDAO_APP_KEY = '你的有道AppKey'
YOUDAO_APP_SECRET = '你的有道AppSecret'
```

**如果使用DeepL翻译：**
```python
DEEPL_API_KEY = '你的DeepL_API_Key'
```

### 4. 运行脚本
```bash
python translate_excel.py
```

运行后，程序会：
1. **选择翻译服务**：选择使用有道翻译（输入1）或DeepL翻译（输入2）
2. 显示Excel文件的前5行预览，帮助你了解文件结构
3. 提示你输入要翻译的列号（源列），可以直接回车使用默认值（第1列）
4. 提示你输入翻译结果要填入的列号（目标列），可以直接回车使用默认值（第2列）
5. 询问是否跳过第一行（标题行）
6. 询问是否调整翻译延时时间（用于避免频率限制，默认1秒）
7. 开始自动翻译

**列号输入示例**：
- 输入 `A` 或 `1` 表示第一列
- 输入 `B` 或 `2` 表示第二列
- 输入 `C` 或 `3` 表示第三列
- 以此类推...

## 文件说明
- `translate_excel.py` - 主程序脚本
- `中英互译测试.xlsx` - 测试用的Excel文件
- `README.md` - 项目说明文档

## 注意事项

### 频率限制问题
- 有道翻译API有调用频率限制（免费账户通常较严格）
- 如果遇到"请求频率超限"错误：
  - 程序会自动重试（等待5秒、10秒、15秒后分别重试，最多3次）
  - 建议增加延时时间：在程序提示时输入更大的数值（如2或3秒）
  - 免费账户建议使用2-3秒的延时
- 如果仍然频繁出现频率限制，可能是：
  - API账户额度不足或权限受限
  - 短时间内请求过多，需要等待更长时间

### 其他注意事项
- 确保Excel文件源列有内容需要翻译
- 请妥善保管API密钥，不要泄露
- 单次翻译文本长度不能超过5000字符
- 如果翻译失败，会在控制台显示详细错误信息，该行的目标列将显示"翻译失败"

### 错误代码说明
- **202/411/412**：频率限制错误，程序会自动重试
- **108/109**：API密钥错误，请检查AppKey和AppSecret
- **401**：账户余额不足，需要充值
- **103**：文本过长，超过5000字符限制

